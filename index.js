const TelegramBot = require('node-telegram-bot-api');
require('dotenv').config();

const token = process.env.TELEGRAM_BOT_TOKEN;
const bot = new TelegramBot(token, { polling: true });

const messages = {
  start: `ü§©–£—Ä–∞, –≤–∞–º –¥–æ—Å—Ç–∞–ª–∞—Å—å —Ä—É–∫–æ–ø–∏—Å—å –º–æ–µ–π –Ω–æ–≤–æ–π –∫–Ω–∏–≥–∏ ‚Äú–í—Å–µ –Ω–∞—à–∏ –¥–µ–º–æ–Ω—ã‚Äù.ü§©\n\n–≠—Ç–æ —Ç–≥-–±–æ—Ç, –≥–¥–µ –º–æ–∂–Ω–æ —É–¥–æ–±–Ω–æ —á–∏—Ç–∞—Ç—å, –ø–∏—Å–∞—Ç—å –æ—Ç–∑—ã–≤—ã (–∞ –æ–Ω–∏ –º–Ω–µ –æ—á–µ–Ω—å –≤–∞–∂–Ω—ã, –∫–æ–Ω–µ—á–Ω–æ –∂–µ), —Å–ª—É—à–∞—Ç—å —Å–∞—É–Ω–¥—Ç—Ä–µ–∫ –∏ –ø–æ–ª—É—á–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –≤—ã—Ö–æ–¥–µ –≥–ª–∞–≤.\n\n–ú–Ω–µ —Ö–æ—Ç–µ–ª–æ—Å—å —Å–¥–µ–ª–∞—Ç—å —á—Ç–æ-—Ç–æ –æ—Å–æ–±–µ–Ω–Ω–æ–µ, —á—Ç–æ –±—É–¥–µ—Ç –Ω–µ –ø—Ä–æ—Å—Ç–æ —á—Ç–µ–Ω–∏–µ–º, –∞ –∫–∞–∫–∏–º-—Ç–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–º –æ–ø—ã—Ç–æ–º. –°–ø–∞—Å–∏–±–æ, —á—Ç–æ —Ä–µ—à–∏–ª–∏ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å! ü§©\n\n–ö–Ω–∏–≥–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∫–Ω–æ–ø–∫–µ –≤ –ª–µ–≤–æ–º —É–≥–ª—É! –ù–æ –≤–æ–∑–º–æ–∂–Ω–æ —Ç—ã —Ö–æ—á–µ—à—å –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –∞–Ω–Ω–æ—Ç–∞—Ü–∏–µ–π? –ù—É –∏–ª–∏ —Å—Ä–∞–∑—É –ø–µ—Ä–µ–π—Ç–∏ –∫ —Å–∞—É–Ω–¥—Ç—Ä–µ–∫—É –≥–ª–∞–≤—ã?`,
  annotation: `\n\n‚Äú–í—Å–µ –Ω–∞—à–∏ –¥–µ–º–æ–Ω—ã‚Äù - —ç—Ç–æ —Ñ—ç–Ω—Ç–µ–∑–∏-—Ä–æ–º–∞–Ω —á–µ—Ä–µ–∑ –∫–æ—Ç–æ—Ä—ã–π —è –ø—ã—Ç–∞–ª–∞—Å—å –ø–æ–Ω—è—Ç—å –æ—Ç–Ω–æ—à–µ–Ω–∏—è –∫ –º–Ω–æ–∂–µ—Å—Ç–≤–∞–º –≤–µ—â–∞–º–∏: —Ä–µ–ª–∏–≥–∏–∏, –ø–æ–ª–∏—Ç–∏–∫–µ, –∫–∞–ø–∏—Ç–∞–ª–∏–∑–º—É, —Ñ–µ—Ç–∏—à–∞–º, –Ω—É –∏ –ª—é–±–≤–∏.\n\nü§©ü§©ü§©\n\n–ö–∞–ª–µ–± ‚Äî –æ—Ö–æ—Ç–Ω–∏–∫ –Ω–∞ –¥–µ–º–æ–Ω–æ–≤, —á—å—è –∂–∏–∑–Ω—å –¥–∞–≤–Ω–æ –ø–æ—Ç–µ—Ä—è–ª–∞ —Å–º—ã—Å–ª. –û–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç–¥–∞–ª —Å–µ–±—è —Ü–µ—Ä–∫–≤–∏ –∏ —Å–ª—É–∂–µ–Ω–∏—é. –ö–æ–≥–¥–∞ –µ–º—É –±—ã–ª–æ —à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç—å, –æ–Ω –≤—Å—Ç—Ä–µ—Ç–∏–ª –µ–µ - –¥–µ–≤—É—à–∫—É –≤ –∫—Ä–∏—Å—Ç–∞–ª—å–Ω–æ–º –≥—Ä–æ–±—É, –∏ —Å —Ç–æ–≥–æ –¥–Ω—è –µ–µ –æ–±—Ä–∞–∑ —Å—Ç–∞–ª —Ç–∞–π–Ω–æ–π –æ–¥–µ—Ä–∂–∏–º–æ—Å—Ç—å—é –∏ —Å—Ç—ã–¥–ª–∏–≤—ã–º —Å–µ–∫—Ä–µ—Ç–æ–º. –ù–æ —Å–ø—É—Å—Ç—è —Ç—Ä–∏–¥—Ü–∞—Ç—å –ª–µ—Ç –æ–Ω –≤—Å—Ç—Ä–µ—á–∞–µ—Ç –µ–µ –≤–Ω–æ–≤—å. –£–∂–µ –∂–∏–≤–æ–π.\n\n–õ–µ–π–Ω –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –Ω–µ —Ö—Ä—É–ø–∫–æ–π –±–µ–∑–∑–∞—â–∏—Ç–Ω–æ–π –¥–µ–≤—É—à–∫–æ–π, –∞ —è—Ä–æ—Å—Ç–Ω–æ–π –∏ –∏–∑–æ–±—Ä–µ—Ç–∞—Ç–µ–ª—å–Ω–æ–π –≤–µ–¥—å–º–æ–π, –∫–æ—Ç–æ—Ä—É—é –æ–ø–∞—Å–∞—é—Ç—Å—è –¥–∞–∂–µ –≤–µ—Ä—Ö–æ–≤–Ω—ã–µ –¥–µ–º–æ–Ω—ã...\n\nü§©ü§©ü§©\n\n–¢—ç–≥–∏: Dark Fantasy, Enemies to Lovers, Found Family, Grumpy x Sunshine, Slowburn, Complicated Relationship, Hard Magic system`,
  warning1: `\n\nü§©–ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ç–æ–Ω–∫–æ—Å—Ç–∏ü§©\n\n–û—Ç–∑—ã–≤ –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç. –ü—Ä–æ—Å—Ç–æ –ø–∏—à–∏—Ç–µ —ç—Ç–æ–º—É –±–æ—Ç—É —Ç–∞–∫, –∫–∞–∫ –ø–∏—à–∏—Ç–µ —Å–≤–æ–µ–π –ø–æ–¥—Ä—É–∂–∫–µ –≤ –Ω–æ—á–∏ –ø–æ –ø–æ–≤–æ–¥—É –Ω–æ–≤–æ–≥–æ —Ñ–∞–Ω—Ñ–∏–∫–∞. –≠–º–æ–¥–∑–∏, —Å—Ç–∏–∫–µ—Ä—ã, –ª—é–±—ã–µ —Ä–µ–∞–∫—Ü–∏–∏, —Ä–µ—Ü–µ–Ω–∑–∏–∏, –∫–∞–∫ —É–≥–æ–¥–Ω–æ. –Ø —Ö–æ—Ç–µ–ª–∞, —á—Ç–æ–±—ã —É —á–∏—Ç–∞—Ç–µ–ª—è –±—ã–ª–∞ –ø–æ–ª–Ω–∞—è —Å–≤–æ–±–æ–¥–∞ –¥–µ–π—Å—Ç–≤–∏–π. ü§©`,
  warningChoice: `\n\n–°–ø–∞—Å–∏–±–æ! –•–æ—á–µ—à—å –ø—Ä–æ—á–∏—Ç–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –ø–µ—Ä–µ–¥ –∫–Ω–∏–≥–æ–π –∏ Trigger warning?`,
  warning2: `\n\n–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è:\n–¢–∞–∫ –∫–∞–∫ –∫–Ω–∏–≥–∞ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –ø–∏—Å–∞–ª–∞—Å—å –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º, —è –∏—Å–ø–æ–ª—å–∑—É—é –∞–Ω–≥–ª–∏–π—Å–∫–∏–π –≤–∞—Ä–∏–∞–Ω—Ç –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –ø—Ä—è–º–æ–π —Ä–µ—á–∏.\n\n–í —Ä–∞–±–æ—Ç–µ –º–æ–≥—É—Ç –≤—Å—Ç—Ä–µ—á–∞—Ç—å—Å—è –æ—à–∏–±–∫–∏. –ü–µ—Ä–≤—ã–µ —Ç—Ä–∏ –≥–ª–∞–≤—ã –±—ã–ª–∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã –ò–º–∞–Ω –ú—É—Å–∞–µ–≤–æ–π. –°–ø–∞—Å–∏–±–æ –µ–π –æ–≥—Ä–æ–º–Ω–æ–µ!\n\nü§©–ì—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ –Ω–∞—Å–∏–ª–∏–µ (–≤–∫–ª—é—á–∞—è —Å—Ü–µ–Ω—ã —É–±–∏–π—Å—Ç–≤, –ø—ã—Ç–æ–∫ –∏ –±–æ–µ–≤—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π).\nü§©–£–ø–æ–º–∏–Ω–∞–Ω–∏—è –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–π —Å–æ–∑–Ω–∞–Ω–∏–µ–º –∏ –ø—Å–∏—Ö–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è.\nü§©–°–ª–æ–∂–Ω—ã–µ –∏ —Ç–æ–∫—Å–∏—á–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è –º–µ–∂–¥—É –ø–µ—Ä—Å–æ–Ω–∞–∂–∞–º–∏.\nü§©–¢–µ–º–∞ –æ–¥–µ—Ä–∂–∏–º–æ—Å—Ç–∏ –∏ –º–æ—Ä–∞–ª—å–Ω–æ–π –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏.\nü§©–û–ø–∏—Å–∞–Ω–∏–µ —Ç—Ä–∞–≤–º–∏—Ä—É—é—â–∏—Ö —Å–æ–±—ã—Ç–∏–π (–≤–∫–ª—é—á–∞—è –ø–æ—Ç–µ—Ä—é –±–ª–∏–∑–∫–∏—Ö, –ø—Ä–µ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–æ, –Ω–∞—Å–∏–ª–∏–µ).\nü§©–ü—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –õ–ì–ë–ö–¢–ö–∏–ê –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π, —Ç–∞–∫–∂–µ —Ä–∞—Å–æ–≤–æ–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ.\n\n–í—Å–µ –≤ —ç—Ç–æ–π –∫–Ω–∏–≥–µ —è–≤–ª—è–µ—Ç—Å—è –≤—ã–¥—É–º–∫–æ–π –∏ –Ω–µ –Ω–∞—Ü–µ–ª–µ–Ω–æ –Ω–∞ –æ—Å–∫–æ—Ä–±–ª–µ–Ω–∏–µ –∫–∞–∫–∏—Ö-–ª–∏–±–æ –≥—Ä—É–ø–ø, –∫—Ä–æ–º–µ, —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ, –º–æ–∏—Ö –¥–µ–º–æ–Ω–æ–≤.`
};

bot.onText(/\/start/, (msg) => {
  bot.sendMessage(msg.chat.id, messages.start, {
    reply_markup: {
      inline_keyboard: [
        [{ text: '–ê–Ω–Ω–æ—Ç–∞—Ü–∏—è', callback_data: 'annotation' }],
        [{ text: '–ú–µ–Ω—é', callback_data: 'menu' }],
      ],
    },
  });
});

bot.on('callback_query', (query) => {
  const chatId = query.message.chat.id;
  let newText = messages.start;
  let newKeyboard = [
    [{ text: '–ê–Ω–Ω–æ—Ç–∞—Ü–∏—è', callback_data: 'annotation' }],
    [{ text: '–ú–µ–Ω—é', callback_data: 'menu' }]
  ];

  if (query.data === 'annotation') {
    newText += messages.annotation;
  } else if (query.data === 'menu') {
    newText += messages.warning1 + messages.warningChoice;
    newKeyboard = [
      [{ text: '–ü—Ä–æ—á–∏—Ç–∞—Ç—å', callback_data: 'read_warning' }],
      [{ text: '–ù–µ—Ç, —Å–ø–∞—Å–∏–±–æ', callback_data: 'skip_warning' }]
    ];
  } else if (query.data === 'read_warning') {
    newText += messages.warning2;
  } else if (query.data === 'skip_warning') {
    newText += '\n\n–•–æ—Ä–æ—à–æ, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º!';
  }

  bot.editMessageText(newText, {
    chat_id: chatId,
    message_id: query.message.message_id,
    reply_markup: {
      inline_keyboard: newKeyboard
    }
  });
});